## Vagrant の仮想環境を削除する  
  
  id       name    provider state   directory                           
----------------------------------------------------------------------
xxxxxxx  default libvirt running /home/username/Boxes/Demo  
    
一つだけ仮想環境が ON のままだったのでディレクトリに行って halt しようと  
しても見つからない
`find . -type d -name "Demo" 2>/dev/null`  
これで探してみてもヒットしない  
表示のバグではなかったので ChatGPT に聞くと  
**「仮想マシン情報だけ残っている」状態**  
**フォルダ自体が消えても、Vagrant は vagrant global-status にキャッシュ的に情報を保持しているので、存在しないディレクトリのマシンもリストに残る**  
  
「もし」が怖いので
`vagrant global-status --prune`  
でディレクトリが存在しても良いように削除した  

・存在する仮想環境を削除する場合  
1. `vagrant status`  
2. `vagrant destroy <ID>`  
3. `rm -rf <ディレクトリ名>`  
・存在しない仮想環境を削除する場合  
1. `vagrant status`   
2. `vagrant global-status --prune`  
  
本来はバックアップをとってから削除が良いとされている  
方法１：仮想環境内からホストにデータを渡す  
1. /vagrant など共有フォルダあり(cp)  
``` bash
# 仮想マシンにログイン
cd /path/to/vagrant/project
vagrant ssh

# 仮想マシン内のデータを共有フォルダにコピー
cp -r /home/vagrant/data /vagrant/data_backup

# ログアウト
exit
``` 
・ホストの Vagrant プロジェクトフォルダに data_backup が作られる  
・共有フォルダ経由なので簡単・高速  
  
2. 共有フォルダなし(scp)  
SSH 設定を確認する
``` bash 
vagrant ssh-config
```  
・HostName, Port, User, IdentityFile をメモしておく  
ホストにコピーする  
``` bash  
scp -i .vagrant/machines/default/virtualbox/private_key \
    -P 2222 \
    -r vagrant@127.0.0.1:/home/vagrant/data /home/s24016/Backup/data_backup
``` 
-i → Vagrant が用意した秘密鍵  
-P → ポート番号（ssh-config の Port を使用）  
  
/home/s24016/Backup/data_backup → ホスト側の保存先
    
ポイント：  
共有フォルダがある場合は cp が最も簡単  
共有フォルダがない場合や別ホストに送る場合は scp が必要  



---

